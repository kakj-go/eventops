version: 1.0
name: echo-inputs-env-and-file-value

actuatorSelector:
  tags:
    - os-runner

inputs:
  - name: echo_env_value
    type: env
  - name: echo_file_value
    type: file

contexts:
  - name: context_env_value
    type: env
  - name: context_file_value
    type: file

dag:
  - name: os-echo
    needs:
      - root
  - name: os-output-context-echo
    needs:
      - os-echo

tasks:
  - alias: os-echo
    type: os
    outputs:
      - name: env_output
        value: echoName
        type: env
        setToContext: context_env_value
      - name: file_output
        value: $outputFile
        type: file
        setToContext: context_file_value
    commands:
      - echo "${{ inputs.echo_env_value }}"
      - cat ${{ inputs.echo_file_value }}
      - export echoName='os-echo env output value'
      - echo "os-echo file output value" > output.txt
      - export outputFile=`pwd`/output.txt
  - alias: os-output-context-echo
    type: os
    commands:
      - echo "os-echo output print"
      - echo "${{ outputs.os-echo.env_output }}"
      - cat ${{ outputs.os-echo.file_output }}
      - echo "context print"
      - echo "${{ contexts.context_env_value }}"
      - cat ${{ contexts.context_file_value }}
      - echo "input print"
      - echo "${{ inputs.echo_env_value }}"
      - cat ${{ inputs.echo_file_value }}
